<h2>{caption}</h2>
<link rel="stylesheet" href="/css/autocomplete.css">

<form id="tabfilter" class="container" action="javascript:MaintainChildren.filterShow()">

  <div class="row">
    <div class="col">
      <span>{child_name}</span>
    </div>
    <div class="col">
      <input type="text" name="ChildName" value="">
    </div>
  </div>

  <div class="row">
    <div class="col">
      <span>{donor_name}</span>
    </div>
    <div class="col">
      <input type="text" name="DonorName" value="">
    </div>
  </div>

  <div class="row">
    <div class="col">
      <span>{child_without_donor}</span>
    </div>
    <div class="col">
      <input type="checkbox" name="ChildWithoutDonor" value="">
    </div>
  </div>

  <!-- status -->
  <div class="row">
    <div class="col">
      <span>{partner_status}</span>
    </div>
    <div class="col">
      <select type="text" name="ASponsorshipStatus" value="">
        <option value="" selected>{forms.any}</option>
      </select>
    </div>
  </div>

  <!-- admin -->
  <div class="row">
    <div class="col">
      <span>{sponsor_admin}</span>
    </div>
    <div class="col">
      <select type="text" name="ASponsorAdmin" value="">
        <option value="">{forms.any}</option>
      </select>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <span>{forms.sortby}:</span>
    </div>
    <div class="col">
      <select name="ASortBy">
        <option value="ChildName" selected>{sort_by_name}</option>
        <option value="SponsorAdmin">{sort_by_sponsor_admin}</option>
      </select>
    </div>
  </div>

  <!-- button -->
  <div class="row">
    <div class="col">
      <button type="button" class="btn btn-secondary" onclick="save_preset('MaintainChildren')">{forms.save_preset}</button>
      <button type="submit" class="btn btn-primary">{forms.filter}</button>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <button type="button" class="btn btn-primary" onclick="MaintainChildren.showCreate()">{new_child}</button>
      <button type="button" class="btn btn-secondary" onclick="MaintainChildren.print()">{forms.printlist}</button>
      <button type="button" class="btn btn-secondary" onclick="MaintainChildren.export()">{forms.exportlist}</button>
    </div>
    <div class="col">
    </div>
  </div>

</form>

<div class="container" id="browse">
  <div class="row">
    <div class="col"><b>{child_name}</b></div>
    <div class="col"><b>{partner_status}</b></div>
    <div class="col"><b>{donor_name}</b></div>
    <div class="col"><b>{sponsor_admin}</b></div>
    <div class="col-1"></div>
  </div>

  <div id="result" class="container container-list">
    <!-- gets filled with copys of: [phantom] .children -->
  </div>
</div>

<div phantom hidden>

  <div class="tpl_row children" id="child{val_p_partner_key_n}">
  <div class="row">
    <div class="invisible">
      <data name="p_partner_key_n" value="-1"></data>
    </div>    
    <div class="col">
      <span type="text" name="p_first_name_c"></span> <span type="text" name="p_family_name_c"></span>
    </div>
    <div class="col">
      <span type="text" name="p_type_description_c"></span>
    </div>
    <div class="col">
      <span type="text" name="SponsorName"></span>
    </div>
    <div class="col">
      <span type="text" name="p_user_id_c"></span>
    </div>
    <div class="col-2" style="margin-top:0.3em;">
      <button type="button" class="btn btn-primary" onclick="MaintainChildren.open_detail(this)">
        <i class="fas fa-folder-open"></i>
      </button>
      <button id="btnEdit" type="button" class="btn btn-primary" onclick="MaintainChildren.edit(this)" title="{forms.edit}">
        <i class="fas fa-wrench"></i>
      </button>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <div class="collapse_col"></div>
    </div>
  </div>
  </div>

  <div class="collapse tpl_view">
    <div class="container group-container">
      <div class="row" style="margin-top:0.5em;">
        <div class="col">
        </div>
        <div class="col-1">
          <button type="button" class="btn btn-light" onclick="$('.tpl_row .collapse').collapse('hide');" title="{forms.close}">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
      <div class="row">
        <div class="col"><span type="text" name="SponsorContactDetails"></span></div>
      </div>
    </div>
  </div>

  <div class="row comment">
    <div class="col">
      <span type="date" name="s_date_created_d"></span>
    </div>
    <div class="col" title="{val_p_comment_c}">
      <span name="p_comment_short_c"></span>
    </div>
    <div class="col-1">
      <data name="p_comment_type_c" value="-1"></data>
      <data name="p_index_i" value="-1"></data>
      <data name="p_partner_key_n" value="-1"></data>
      <button type="button" class="btn btn-primary" onclick="MaintainChildComments.edit(this)"><i class="fas fa-wrench"></i></button>
    </div>
  </div>

  <div class="sponsorship">
  <div class="row">
    <div class="col">
      <span name="DonorName"></span>
    </div>
    <div class="col">
      <span name="a_motivation_detail_code_c"></span>
    </div>
    <div class="col">
      <span type="currency" name="a_gift_amount_n"></span>
    </div>
    <div class="col">
      <span type="date" name="a_start_donations_d"></span>
    </div>
    <div class="col">
      <span type="date" name="a_end_donations_d"></span>
    </div>
    <div class="col-1">
      <data name="p_partner_key_n"></data>
      <data name="a_ledger_number_i"></data>
      <data name="a_batch_number_i"></data>
      <data name="a_gift_transaction_number_i"></data>
      <data name="a_detail_number_i"></data>
      <button type="button" class="btn btn-primary" onclick="MaintainChildSponsorship.edit(this)"><i class="fas fa-wrench"></i></button>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <span name="SponsorAddress"></span>
      <span name="SponsorEmailAddress"></span>
      <span name="SponsorPhoneNumber"></span>
    </div>
  </div>
  </div>

  <div class="row reminder">
    <div class="col">
      <span type="date" name="p_event_date_d"></span>
    </div>
    <div class="col" title="{val_p_comment_c}">
      <span name="p_comment_short_c"></span>
    </div>
    <div class="col">
      <span type="date" name="p_first_reminder_date_d"></span>
    </div>
    <div class="col-1">
      <data name="p_reminder_id_i" value="-1"></data>
      <data name="p_partner_key_n" value="-1"></data>
      <button type="button" class="btn btn-primary" onclick="MaintainChildReminders.edit(this)"><i class="fas fa-wrench"></i></button>
    </div>
  </div>


</div>

<div class="modal modal-wide fade" tabindex="-2" role="dialog" id="detail_modal" mode="create/edit">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3>{edittitle}</h3>
      </div>
      <div class="modal-body">

        <div class="container">

          <div class="row" mode-hide="create">
            <div class="col-3">
              <span>{partner_key}</span>
            </div>
            <div class="col-3">
              <input type="text" name="p_partner_key_n" value="" readonly/>
            </div>
          </div>

          <div class="row">
            <div class="col-3">
              <span>{partner_status}</span>
            </div>
            <div class="col-3">
              <select name="ASponsorshipStatus">
              </select>
            </div>
          </div>

          <div class="row">
            <div class="col-3">
              <span>{partner_firstname}</span>
            </div>
            <div class="col-3">
              <input type="text" name="p_first_name_c"/>
            </div>
            <div class="col-3">
              <span>{partner_lastname}</span>
            </div>
            <div class="col-3">
              <input type="text" name="p_family_name_c"/>
            </div>
          </div>

          <ul class="nav nav-tabs" role="tablist" mode-hide="create">

            <li class="nav-item">
              <div class="nav-link active" href="javascript:void(0)" onclick="MaintainChildren.showWindow(this)" show="details">{details}</div>
            </li>
            <li class="nav-item">
              <div class="nav-link" href="javascript:void(0)" onclick="MaintainChildren.showWindow(this)" show="sponsorship">{sponsorship}</div>
            </li>
            <li class="nav-item">
              <div class="nav-link" href="javascript:void(0)" onclick="MaintainChildren.showWindow(this)" show="dates_reminder">{dates_reminder}</div>
            </li>
            <li class="nav-item">
              <div class="nav-link" href="javascript:void(0)" onclick="MaintainChildren.showWindow(this)" show="family_situations">{family_situations}</div>
            </li>
            <li class="nav-item">
              <div class="nav-link" href="javascript:void(0)" onclick="MaintainChildren.showWindow(this)" show="school_situations">{school_situations}</div>
            </li>

          </ul>

          <div id="multi_window" active="details">

            <!-- details is shown by default, can be changed by a call to MaintainChildren.showWindow(name) -->
            <div window="details">
              <h2>{details}</h2>

              <div class="row">
                <!-- left / infos -->
                <div class="col">

                  <!-- gender -->
                  <div class="row">
                    <div class="col">
                      <span>{gender}</span>
                    </div>
                    <div class="col">
                      <select name="p_gender_c">
                        <option value="UNKNOWN" selected>{unknown}</option>
                        <option value="MALE">{male}</option>
                        <option value="FEMALE">{female}</option>
                      </select>
                    </div>
                  </div>

                  <!-- birthday -->
                  <div class="row">
                    <div class="col">
                      <span>{birthday}</span>
                    </div>
                    <div class="col">
                      <input type="date" name="p_date_of_birth_d">
                    </div>
                  </div>

                  <!-- sponsor_admin -->
                  <div class="row">
                    <div class="col">
                      <span>{sponsor_admin}</span>
                    </div>
                    <div class="col">
                      <select name="p_user_id_c">
                        <option value="">Unknown</option>
                      </select>
                    </div>
                  </div>

                </div>
                <!-- right / photo -->
                <div class="col" mode-hide="create">
                  <div class="row">
                    <div class="col">
                      <img name="p_photo_b" src="" alt="{photo}" height="256">
                    </div>
                  </div>
                  <div class="row">
                    <div class="col">
                      <input type="file" id="new_photo" name="new_photo"  onchange="MaintainChildren.photoPreview()"/>
                      <button type="button" class="btn btn-primary" onclick="MaintainChildren.uploadNewPhoto()">{forms.upload}</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div window="sponsorship" style="display: none;">
              <h2>{sponsorship}</h2>

              <!-- new btn -->
              <div class="row">
                <div class="col">
                  <button type="button" class="btn btn-primary" onclick="MaintainChildSponsorship.showCreate()">{forms.new}</button>
                </div>
              </div>

              <div class="row header">
                <div class="col">
                  <span>{donor}</span>
                </div>
                <div class="col">
                  <span>{motivation_detail}</span>
                </div>
                <div class="col">
                  <span>{amount}</span>
                </div>
                <div class="col">
                  <span>{start_date}</span>
                </div>
                <div class="col">
                  <span>{end_date}</span>
                </div>
                <div class="col-1">
                  <!-- placeholder for btn col -->
                </div>
              </div>

              <div class="container-list" id="sponsorships">
                <!-- gets filled with copys of: [phantom] .sponsorship -->
              </div>

            </div>

            <div window="dates_reminder" style="display: none;">
              <h2>{dates_reminder}</h2>

              <!-- new btn -->
              <div class="row">
                <div class="col">
                  <button type="button" class="btn btn-primary" onclick="MaintainChildReminders.showCreate()">{forms.new}</button>
                </div>
              </div>

              <div class="row header">
                <div class="col">
                  <span>{date}</span>
                </div>
                <div class="col">
                  <span>{description}</span>
                </div>
                <div class="col">
                  <span>{first_reminder_date}</span>
                </div>
                <div class="col-1">
                  <!-- placeholder for btn col -->
                </div>
              </div>

              <div class="container-list" id="dates">
                <!-- gets filled with copys of: [phantom] .reminder -->
              </div>

            </div>

            <div window="family_situations" style="display: none;">
              <h2>{family_situations}</h2>

              <!-- new btn -->
              <div class="row">
                <div class="col">
                  <button type="button" class="btn btn-primary" onclick="MaintainChildComments.showCreate('FAMILY')">{forms.new}</button>
                </div>
              </div>

              <div class="row header">
                <div class="col">
                  <span>{date}</span>
                </div>
                <div class="col">
                  <span>{notes}</span>
                </div>
                <div class="col-1">
                  <!-- placeholder for btn col -->
                </div>
              </div>

              <div class="container-list FAMILY">
                <!-- gets filled with copys of: [phantom] .comment -->
              </div>

            </div>

            <div window="school_situations" style="display: none;">
              <h2>{school_situations}</h2>

              <!-- new btn -->
              <div class="row">
                <div class="col">
                  <button type="button" class="btn btn-primary" onclick="MaintainChildComments.showCreate('SCHOOL')">{forms.new}</button>
                </div>
              </div>

              <div class="row header">
                <div class="col">
                  <span>{date}</span>
                </div>
                <div class="col">
                  <span>{notes}</span>
                </div>
                <div class="col-1">
                  <!-- placeholder for btn col -->
                </div>
              </div>

              <div class="container-list SCHOOL">
                <!-- gets filled with copys of: [phantom] .comment -->
              </div>

            </div>

          </div>
        </div>

      </div>
      <div class="modal-footer">
        <button class="btn btn-danger" onclick="MaintainChildren.delete()">{forms.delete}</button>
        <button class="btn btn-primary" onclick="MaintainChildren.saveEdit()">{forms.save}</button>
        <button class="btn btn-light" onclick="CloseModal(this, false)">{forms.close}</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" tabindex="-1" role="dialog" id="comment_modal" mode="create/edit">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3>{edittitle_comment}</h3>
      </div>
      <div class="modal-body">

        <div class="container">

          <div class="row">
            <data name="p_partner_key_n" value="-1"></data>
            <data name="p_index_i" value="-1"></data>
            <data name="p_comment_type_c" value="-1"></data>
            <textarea name="p_comment_c" rows="8" cols="80"></textarea>
          </div>

        </div>

      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" onclick="MaintainChildComments.saveEdit()">{forms.save}</button>
        <button class="btn btn-light" onclick="CloseModal(this, false)">{forms.close}</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" tabindex="-1" role="dialog" id="reminder_modal" mode="create/edit">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3>{edittitle_reminder}</h3>
      </div>
      <div class="modal-body">

        <div class="container">

          <div class="row">
            <div class="col"><span>{event_date}</span></div>
            <div class="col ml-auto"><input type="date" name="p_event_date_d"></div>
          </div>

          <div class="row">
            <div class="col"><span>{first_reminder_date}</span></div>
            <div class="col ml-auto"><input type="date" name="p_first_reminder_date_d"></div>
          </div>

          <div class="row">
            <data name="p_partner_key_n" value="-1"></data>
            <data name="p_reminder_id_i" value="-1"></data>
            <textarea name="p_comment_c" rows="8" cols="80"></textarea>
          </div>

        </div>

      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" onclick="MaintainChildReminders.saveEdit()">{forms.save}</button>
        <button class="btn btn-light" onclick="CloseModal(this, false)">{forms.close}</button>
      </div>
    </div>
  </div>
</div>

<div class="modal modal-wide fade" tabindex="-1" role="dialog" id="recurring_modal" mode="create/edit">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3>{edittitle_donation}</h3>
      </div>
      <div class="modal-body">

        <div class="container">

          <data name="a_ledger_number_i" value=""></data>
          <data name="a_batch_number_i" value=""></data>
          <data name="a_gift_transaction_number_i" value=""></data>
          <data name="a_detail_number_i" value=""></data>
          <data name="p_recipient_key_n" value=""></data>

          <div class="row">
            <div class="col">
              <span>{donor}</span>
            </div>
            <div class="col">
              <div class="autocomplete">
                <input type="text" name="p_donor_name_c" key-name="p_donor_key_n" value="" oninput="autocomplete_donor(this)" size="40">
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col">
              <span>{motivation_detail}</span>
            </div>
            <div class="col">
              <input type="hidden" name="a_motivation_group_code_c" value=""/>
              <div class="autocomplete">
                <input type="text" name="a_motivation_detail_code_c" value="" oninput="autocomplete_motivation_detail(this)"/>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col">
              <span>{amount}</span>
            </div>
            <div class="col">
              <input type="number" name="a_gift_amount_n" value=""/>
            </div>
          </div>

          <div class="row">
            <div class="col">
              <span>{start_date}</span>
            </div>
            <div class="col">
              <input type="date" name="a_start_donations_d" value=""/>
            </div>
          </div>

          <div class="row">
            <div class="col">
              <span>{end_date}</span>
            </div>
            <div class="col">
              <input type="date" name="a_end_donations_d" value=""/>
            </div>
          </div>

        </div>

      </div>
      <div class="modal-footer">
        <button class="btn btn-danger" onclick="MaintainChildSponsorship.delete(this)">{forms.delete}</button>
        <button class="btn btn-primary" onclick="MaintainChildSponsorship.saveEdit()">{forms.save}</button>
        <button class="btn btn-light" onclick="CloseModal(this, false)">{forms.close}</button>
      </div>
    </div>
  </div>
</div>

<script src="/src/lib/autocomplete.js" charset="utf-8"></script>
<script src="/src/lib/autocomplete_posting_acc_cc.js" charset="utf-8"></script>
<script src="/src/lib/autocomplete_motivation.js" charset="utf-8"></script>
<script src="/src/lib/autocomplete_partner.js" charset="utf-8"></script>
<script src="/src/lib/utils.js" charset="utf-8"></script>
<script src="/src/lib/tpl.js" charset="utf-8"></script>
<script src="/src/lib/modal.js" charset="utf-8"></script>
